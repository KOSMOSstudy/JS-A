# **4주차 JS 스터디 정리**

[제목 없음](https://www.notion.so/9119594b2ae24bbfbd6f2c80f45c6dd4)

## **3장**

### **3.4 노드 내장 객체 알아보기**

### **3.4.1 global**

브라우저의 window와 같은 전역 객체로 모든 파일에서 접근 가능하다.

global은 생략해서 사용가능하다. → 노드 콘솔에 로그를 기록하는 console 객체도 원래는 global.console 이다.

### **3.4.2 console**

보통 console 객체는 디버깅을 위해 사용하며, 노드에서는 console 이 global 객체 안에 들어있다.

- console.time(레이블) : console.timeEnd(레이블)과 대응되어 같은 레이블을 가진 time과 timeEnd 사이의 시간을 측정
- console.log(내용) : 평범한 로그를 콘솔에 표시합니다. Console.log(내용, 내용, …) 처럼 여러 내용을 동시에 표시
- console.error(에러내용) : 에러를 콘솔에 표시
- console.table(배열) : 배열의 요소로 객체 리터럴을 넣으면 객체의 속성들이 테이블 형식으로 표현된다.
- console.dir(객체, 옵션) : 객체를 콘솔에 표시할 때 사용
- console.trace(레이블) : 에러가 어디서 발생했는지 추적할 수 있음

### **3.4.3 타이머**

타이머 기능을 제공하는 함수이다. 

- setTimeout(콜백 함수, 밀리초) : 주어진 밀리초(1,000분의 1초)이후에 콜백 함수를 실행
- setInterval(콜백 함수, 밀리초) : 주어진 밀리초마다 콜백 함수를 반복 실행
- setImmediate(콜백 함수) : 콜백 함수를 즉시 실행

→ 아이디 반환

**아이디를 사용하여 타이머를 취소**

- clearTimeout(아이디) : setTimeout 을 취소
- clearInterval(아이디) : setInterval 을 취소
- clearImmediate(아이디) : setImmediate 를 취소

### **3.4.4 __filename, __dirname**

__filename, __dirname 이라는 키워드로 경로에 대한 정보를 제공

### **3.4.5 module, exports, require**

module 객체 말고 exports 객체로도 모듈을 만들 수 있다. 

→ 두 가지가 모두 동일하게 동작하는 이유는 module.exports 와 exports 가 같은 객체를 참조하기 때문이다. exports와 module.exports에는 참조 관계가 있으므로 한 모듈에 이 두가지를 동시에 사용하는 것는 좋지않다.

### **3.4.6 process**

process 객체는 현재 실행되고 있는 노드 프로세스에 대한 정보를 가진다.

- process.env : REPL에 입력해보면 매우 많은 정보가 출력되는데, 이 정보들은 시스템의 환경 변수
    - 서비스의 중요한 키를 저장하는 공간으로도 사용된다.
        - `const secretId = process.env.SECRET_ID;`
- process.nextTick(콜백) : 이벤트 루프가 다른 콜백 함수들보다 nextTick의 콜백 함수를 우선으로 처리하도록 만듦
    - `마이크로태스트(microtask)` : Promise와 process.nextTick
    - 태스크와 마이크로 태스크
- process.exit(코드) : 실행 중인 노드 프로세스를 종료

### **3.5 노드 내장 모듈 사용하기**

### **3.5.1 os**

os모듈에는 운영체제의 정보가 담겨있다.

### **3.5.2 path**

폴더와 파일의 경로를 쉽게 조작하도록 도와주는 모듈

- 운영체제별로 경로 구분자가 다르기 대문에 중요하다.

### **3.5.3 url**

인터넷 주소를 쉽게 조작하도록 도와주는 모듈

- url 처리 두 가지 방식
    - WHATWG : url 모듈 안에 URL 생성자가 있어서 이 생성자에 주소를 넣고 객체로 만들면 주소가 부분별로 정리된다. username, password, origin, searchParams 속성은 WHATWG에만 존재한다.
    - 예전부터 사용하던 방식의 url
        - url.parse(주소) :: 주소를 분해한다. WHATWG 방식과 비교해보면 username, password 대신에 auth 속성, searchParams 대신에 query가 있다.
        - url.format(객체) :: WHATWG 방식 url과 기존 노드의 url을 모두 사용할 수 있다. 분해되었던 url객체를 다시 원래 상태로 조립한다.

### **3.5.4 querystring**

기존 노드의 url을 사용할 때, search 부분을 사용하기 쉽게 객체로 만드는 모듈

- querystring.parse(쿼리) : url의 query 부분을 자바스크립트 객체로 분해
- querystring.stringify(객체) : 분해된 query 객체를 문자열로 다시 조립

### **3.5.5 crypto**

다양한 방식의 암호화를 도와주는 모듈

- 단방향 암호화 : 한 번 암호화하면 원래 문자열을 찾을 수 없다.해시 함수라고 부르기도 한다.
- 양방향 암호화 : 암호화된 문자열을 복호화할 수 있다.

### **3.5.6 util**

각종 편의 기능을 모아둔 모듈

- util.deprecate : 함수가 deprecated 처리되었음을 알린다.
    
    ```jsx
    const dontUseMe = util.deprecate((x, y) => {
    	console.log(x+y);
    }, '사용하지마세요');
    dontUseMe(1,2); // 함수 사용 시 경고메시지 출력
    ```
    
- util.promisify : 콜백 패턴을 프로미스 패턴으로 바꾼다. 바꿀 함수를 인수로 제공하면된다. async/await 패턴까지 사용 가능해서 좋다.

### **3.5.7 worker_threads**

노드에서 멀티 스레드 방식으로 작업하는 방법은 worker_threads 모듈로 가능

### **3.5.8 child_process**

다른 프로그램을 실행하고 싶거나 명령어를 수행하고 싶을 때 사용하는 모듈

### **3.5.9 기타 모듈들**

### **3.6 파일 시스템 접근하기**

fs 모듈: 은 파일 시스템에 접근하는 모듈

### **3.6.1 동기 메서드와 비동기 메서드**

노드는 대부분의 메서드를 비동기 방식으로 처리한다. 하지만 몇몇 메서드는 동기 방식으로 사용할 수 있는데, fs 모듈이 그런 메서드를 많이 갖고 있다.

### **3.6.2 버퍼와 스트림 이해하기**

readFile과 readFileSync에서 받아온 data를 data.toString()으로 변환하는 이유는 data가 버퍼이기 때문이다.

- 파일을 읽거나 쓰는 방식
    - 버퍼링한다 = 영상을 로딩하는 시간. 상을 재생할 수 있을 때까지 데이터를 모음
    - 스트리밍한다 = 영상을 실시간으로 송출. 영상 데이터를 조금씩 전송
    
- Buffer 객체 메소드
    - from(문자열) : 문자열 → 버퍼
    - toString(버퍼) : 버퍼 → 문자열
    - concat(배열) : 배열 안에 든 버퍼들을 하나로 합치기
    - alloc(바이트) : 빈 버퍼 생성

### **3.6.3 기타 fs 메서드 알아보기**

### **3.6.4 스레드풀 알아보기**

비동기 메서드를 여러 번 실행해도 백그라운드에서 동시에 처리되는 이유는 스레드풀의 존재 때문이다.

- 작업을 동시에 처리하므로 여덟 개의 작업 중에서 어느 것이 먼저 처리될지 모른다.
- 스레드풀을 직접 컨트롤할 수는 없지만 개수는 조절 할 수 있다.

### **3.7 이벤트 이해하기**

events 모듈을 사용하여 객체를 만들어서 사용

- events 관련 메서드

### **3.8 예외 처리하기**

- try / catch 문으로 에러가 발생할 것 같은 부분 감싸기
- 에러가 발생했을 때 에어를 throw 하고,  try / catch 문으로 throw 한 에러를 잡아야한다.
- process 객체에 uncaughtException 이벤트 리스너

### **3.8.1 자주 발생하는 에러들**

### **3.9 함께 보면 좋은 자료**

## **4장**

### **4.1 요청과 응답 이해하기**

클라이언트에서 서버로 request를 보냄

→ 서버에서 요청의 내용을 읽고 처리, 클라이언트에 response

= 이벤트 방식

### **4.2 REST와 라우팅 사용하기**

REST = REpresentational State Transfer

: 서버의 자원을 정의하고 자원에 대한 주소를 지정하는 방법

- 주소는 명사로 구성
    - /user → 사용자 관련 자원 요청
- HTTP 요청 메서드 사용으로 동작 설명
    - GET, POST, PUT, PATCH, DELETE, OPTIONS
- REST를 사용한 주소 체계로 RESTful한 웹 서버 만들기

### **4.3 쿠키와 세션 이해하기**

- 쿠키
    - 유효 기간 존재
    - 키-값 의 쌍
    - 서버로부터 쿠키가 오면 웹브라우저는 쿠키를 저장해두었다가 다음 요청 시 쿠키를 동봉해서 보냄 → 쿠키로 사용자 파악
    - 요청 헤더에 담겨 전송됨
    - 브라우저는 응답의 헤더에 따라 쿠키를 저장

- 세션
    - 세션이라는 객체에 정보를 넣어서 세션아이디를 주고 받는 방식
    - 세션을 위해 사용하는 쿠키 = 세션 쿠키
    
    → 꼭 쿠키를 사용해서 주고받지 않아도 됨
    
    - 실제 배포용 서버 → Redis나 Memcached같은 DB에 넣어둔다

### **4.4 https와 http2**

- https
    - 웹 서버에 SSL암호화 추가
    - GET/ POST요청 시 → 오가는 데이터를 암호화해서 중간에 다른 사람이 요청을 가로채더라도 내용을 확인할 수 없다.
    - 인증서 필요
- http2
    - SSL 암호화 + 최신 HTTP 프로토콜 http/2  사용
    - 기존 http/1.1보다 요청 및 응답 방식이 개선되어 훨씬 효율적으로 요청
        
        → 웹 속도 개선
        

### **4.5 cluster**

cluster 모듈 : 기본적으로 싱글 프로세스로 동작하는 노드가 CPU코어를 모두 사용할 수 있게 해주는 모듈

- 포트를 공유하는 노드 프로세스를 여러개 둘 수 있음

→ 요청이 많이 들어왔을 때, 병렬로 실행된 서버의 개수만큼 요청이 분산되게

- 예기치 못한 에러로인해 서버가 종료되는 현상 방지 : 클러스터링 적용(cluster 모듈로 구현 or pm2 등의 모듈로 cluster 기능 )
- 단점 - 세션을 메모리에 저장하는 경우

→ 해결 : 레디스 등의 서버를 도입

### **4.6 함께 보면 좋은 자료**

---
