# 4주차 JS 스터디 정리

| 장   | 제목          |
| ---- | ------------- |
| 책 3장 마무리 | 노드 기능 |
| 책 4장 | http 모듈로 서버 만들기 |

## 3장

### 3.4 노드 내장 객체 알아보기
### 3.4.1 **global 객체**

: 브라우저의 window와 같은 전역 객체이다. 전역 객체이므로 모든 파일에서 접근 가능하다. (global 생략 가능)

(주의! 노드에 DOM이나 BOM이 없으므로 window와 document 객체는 노드에서 사용할 수 없다.)

### 3.4.2 **console 객체**

: 보통 디버깅을 위해 사용. 개발하면서 변수에 값이 제대로 들어 있는지 확인하기 위해 사용하고, 에러 발생 시 에러 내용을 콘솔에 표시하기 위해 사용하며, 코드 실행 시간을 알아보려고 할 때도 사용한다. 

- **console.time(레이블)** : console.timeEnd(레이블)과 대응되어 같은 레이블을 가진 time과 timeEnd 사이의 시간을 측정한다.
- **console.log(내용)** : 평범한 로그를 콘솔에 표시한다. (여러 내용을 동시에 표시할 수도 있다.)
- **console.table(배열)** : 배열의 요소로 객체 리터럴을 넣으면, 객체의 속성들이 테이블 형식으로 표현된다.
- **console.dir(객체, 옵션)** : 객체를 콘솔에 표시할 때 사용한다. 첫 번째 인수로 표시할 객체를 넣고, 두 번째 인수로 옵션을 넣는다. 옵션의 colors를 true로 하면 콘솔에 색이 추가되어 보기가 한결 편해진다. depth는 객체 안의 객체를 몇 단계까지 보여줄지를 결정한다. (기본값 2) → 객체 로깅
- **console.trace(레이블)** : 에러가 어디서 발생했는지 추적할 수 있게 한다. 일반적으로 에러 발생 시 에러 위치를 알려주므로 자주 사용하지는 않지만, 위치가 나오지 않는다면 사용할 만 하다. → 호출스택 로깅

### 3.4.3 타이머

타이머 기능을 제공하는 함수인 setTimeout, setInterval, setImmediate는 노드에서 window 대신 global 객체 안에 들어가 있다. → 비동기 코드

- **setTimeout(콜백 함수, 밀리초)** : 주어진 밀리초(1000분의 1) 이후에 콜백함수를 실행한다.
- **setInterval(콜백 함수, 밀리초)** : 주어진 밀리초마다 콜백 함수를 반복 실행한다.
- **setImmediate(콜백 함수)** : 콜백 함수를 즉시 실행한다.

이 타이머 함수들은 모두 아이디를 반환한다. 아이디를 사용하여 타이머를 취소할 수 있다.

- **clearTimeout(아이디)** : setTimeout을 취소한다.
- **clearInterval(아이디)** : setInterval을 취소한다.
- **clearImmediate(아이디)** : setImmdiate를 취소한다.

### 3.4.4 __filename, __dirname

- __filename : 현재 파일 경로
- __dirname : 현재 폴더(디렉터리) 경로

### 3.4.5 module, exports, require

module 객체 말고 exports 객체로도 모듈을 만들 수 있다.

- exports 객체를 사용할 때는 module.exports와의 참조 관계가 깨지지 않도록 주의해야 한다. module.exports에는 어떤 값이든 대입해도 되지만, exports에는 반드시 객체처럼 속성명과 속성값을 대입해야 한다. exports에 다른 값을 대입하면 객체의 참조 관계가 끊겨 더 이상 모듈로 기능하지 않는다.

**[노드에서 this를 사용할 때 주의해야 할 점]**

최상위 스코프에 존재하는 this는 module.exports(또는 exports 객체)를 가리킨다. 또한, 함수 선언문 내부의 this는 global 객체를 가리킨다.

[require는 함수이고, 함수는 객체이므로 require는 객체로서 몇 가지 속성을 갖고 있다.]

- require가 제일 위에 올 필요 없다.
- require.cache에 한 번 require한 모듈에 대한 캐슁 정보가 들어있다.
- requrie.main은 노드 실행 시 첫 모듈을 가리킨다.

### 3.4.6 process

process 객체 : 현재 실행되고 있는 노드 프로세스에 대한 정보를 담고 있다.

- **process.version** : 설치된 노드의 버전
- **process.arch :** 프로세서 아키텍처 정보
- **process.pid** : 현재 프로세스의 아이디
- **process.uptime()** : 프로세스가 시작된 후 흐른 시간 (단위 초)
- **process.execPath()** : 노드의 경로
- **process.cwd()** : 현재 프로세스가 실행되는 위치
- **process.cpuUsage()** : 현재 cpu 사용량

**process.env**

: 시스템 환경 변수들이 들어있는 객체

- 비밀키(데이터베이스 비밀번호, 서드파티 앱 키 등)를 보관하는 용도로도 쓰인다.
- 환경 변수는 process.env로 접근 가능하다.
- 일부 환경 변수는 노드 실행 시 영향을 미친다.

**process.nextTick(콜백)**

: 이벤트 루프가 다른 콜백 함수들보다 nextTick의 콜백 함수를 우선적으로 처리한다.

- 너무 남용하면 다른 콜백 함수들 실행이 늦어진다.
- 비슷한 경우로 promise가 있음(nextTick처럼 우선순위가 높음)

**process.exit(코드)**

: 현재의 프로세스를 멈춘다.

- 코드가 없거나 0이면 정상 종료지만, 이외의 코드는 비정상 종료를 의미한다.

## 3.5 노드 내장 모듈 사용하기

### 3.5.1 OS

운영체제의 정보를 담고 있다. (모듈은 require로 가져온다.)

- **os.arch()** : process.arch와 동일
- **os.platform()** : process.platform과 동일
- **os.type()** : 운영체제의 종류를 보여준다.
- **os.uptime()** : 운영체제 부팅 이후 흐른 시간(초)을 보여준다. process.uptime()은 노드의 실행시간이었다.
- **os.hostname()** : 컴퓨터의 이름을 보여준다.
- **os.release()** : 운영체제의 버전을 보여준다.
- **os.homedir()** : 홈 디렉터리 경로를 보여준다.
- **os.tmpdir()** : 임시 파일 저장 경로를 보여준다.
- **os.cpus()** : 컴퓨터의 코어 정보를 보여준다. → os.cpus().length를 하면 코어의 개수가 숫자로 나온다.
- **os.freemem()** : 사용 가능한 메모리(RAM)를 보여준다.
- **os.totalmem()** : wjscp apahfl dydfiddmf qhduwnsek.
- **os.constants** : 각종 에러와 신호에 대한 정보가 담겨 있다.

### 3.5.2 path

폴더와 파일의 경로를 쉽게 조작하도록 도와주는 모듈이다.

- **path.sep** : 경로의 구분자 (윈도는 \, POSIX는 /이다)
- **path.delimiter :** 환경 변수의 구분자이다. process.env.PATH를 입력하면 여러 개의 경로가 이 구분자로 구분되어 있다. (윈도는 세미콜론(;), POSIX는 콜론(:))
- **path.dirname(경로**) : 파일이 위치한 폴더 경로를 보여준다.
- **path.extname(경로)** : 파일의 확장자를 보여준다.
- **path.basename(경로, 확장자)** : 파일의 이름(확장자 포함)을 표시한다. 파일의 이름만 표시하고 싶다면 basename의 두 번째 인수로 파일의 확장자를 넣으면 된다.
- **path.parse(경로) :** 파일 경로를 root, dir, base, exit, name으로 분리한다.
- **path.format(객체)** : path.parse()한 객체를 파일 경로로 합친다.
- **path.normalize(경로)** : / 나 \ 를 실수로 여러 번 사용했거나 혼용했을 때 정상적인 경로로 변환한다.
- **path.isAbsolute(경로)** : 파일의 경로가 절대경로인지 상대경로인지를 true난 false로 알린다.
- **path.relative(기준경로, 비교경로)** : 경로를 두 개 넣으면 첫 번째 경로에서 두 번째 경로로 가는 방법을 알린다.
- **path.join(경로, ...)** : 여러 인수를 넣으면 하나의 경로로 합친다. 상대경로인 ..(부모 디렉터리)과 . (현 위치)도 알아서 처리한다.

### 3.5.3 url

- **getAll(키) :** 키에 해당하는 모든 값들을 가져온다.
- **get(키) :** 키에 해당하는 첫 번째 값만 가져온다.
- **has(키) :** 해당 키가 있는지 없는지를 검사한다.
- **keys() :** searchParams의 모든 키를 반복기 객체로 가져온다.
- **values() :** searchParams의 모든 값을 반복기 객체로 가져온다.
- **append(키, 값) :** 해당 키를 추가한다. 같은 키의 값이 있다면 유지하고 하나 더 추가한다.
- **set(키, 값) :** append와 비슷하지만, 같은 키의 값들을 모두 지우고 새로 추가한다.
- **delete(키) :** 해당 키를 제고한다.
- **toString() :** 조작한 searchParams객체를 다시 문자열로 만든다. 이 문자열은 search에 대입하면 주소 객체에 반영된다.

### 3.5.4 querystring

- **querystring.parse(쿼리) :** url의 query 부분을 자바스크립트 객체로 분해한다.
- **querystring.stringify(객체) :** 분해된 query 객체를 문자열로 다시 조립한다.

### 3.5.5. crypto

다양한 방식의 암호화를 도와주는 모듈이다. 

### 3.5.6 util

util이라는 이름처럼 각종 편의 기능을 모아둔 모듈이다. 계속해서 APT가 추가되고 있으며, 가끔 deprocated되어 사라지는 경우도 있다. 

### 3.5.7 worker_threads

노드에서 멀티 스레드 방식으로 작업하는 방법을 소개한다. 

### 3.5.8 child_process

- 노드에서 다른 프로그램을 실행하고 싶거나 명령어를 수행하고 싶을 때 사용하는 모듈이다.
- 이 모듈을 통해 다른 언어의 코드를 실행하고 결괏값을 받을 수 있다.
- 이름이 child_process(자식 프로세스)인 이유는 현재 노드 프로세스 외에 새로운 프로세스를 띄워서 명령을 수행하고, 노드 프로세스에 결과를 알려주기 때문이다.

## 3.6 파일 시스템 접근하기

- fs 모듈은 파일 시스템에 접근하는 모듈이다. 즉, 파일을 생성하거나 삭제하고, 읽거나 쓸 수 있다. 폴더도 만들거나 지울 수 있다.
- fs 모듈을 불러온 뒤 읽을 파일의 경로를 지정한다. 여기서 파일의 경로가 현재 파일 기준이 아니라 node 명령어를 실행하는 콘솔 기준이라는 점을 유의해라.

## 3.8 예외 처리하기

- 노드에서는 예외 처리가 정말 중요하다.
- 예외란 보통 처리하지 못한 에러를 가리킨다. 이러한 예외들은 실행 중인 노드 프로세스를 멈추게 만든다.
- 멀티 스레드 프로그램에서는 스레드 하나가 멈추면 그 일을 다른 스레드가 대신한다. 하지만 노드의 메인 스레드는 하나뿐이므로 그 하나를 소중히 보호해야 한다 .메인 스레드가 에러로 인해 멈춘다는 것은 스레드를 갖고 있는 프로세스가 멈춘다는 뜻이고, 전체 서버도 멈춘다는 뜻과 같다. 아무리 신중을 기해 만들었다고 해도 항상 예기치 못한 에러는 발생하는 법이다.


## 4장
### 4.1 요청과 응답 이해하기

서버는 클라이언트가 있기에 동작한다. 클라이언트에서 서버로 요청을 보내고, 서버에서는 요청의 내용을 읽고 처리한 뒤 클라이언트에 응답을 보낸다. 

### 4.2 REST와 라우팅 사용하기

- **GET** : 서버 자원을 가져오고자 할 때 사용한다. 요청의 본문에 데이터를 넣지 않는다. 데이터를 서버로 보내야 한다면 쿼리스트링을 사용한다.
- **POST :** 서버에 자원을 새로 등록하고자 할 때 사용한다. 요청의 본문에 새로 등록할 데이터를 넣어 보낸다.

### **4.3 쿠키와 세션 이해하기**

서버는 미리 클라이언트에 요청자를 추정할 만한 정보를 쿠키로 만들어 보내고, 그 다음부터는 클라이언트로부터 쿠키를 받아 요청자를 파악한다. 쿠키가 누구인지 추적하고 있는 것이다. 개인정보 유출 방지를 위해 쿠키를 주기적으로 지우라고 권고하는 것은 바로 이러한 이유 때문이다. 

### 4.4 https와 http2

https 모듈은 웹 서버에 SSL 암호화를 추가한다. GET이나 POST 요청을 할 때 오가는 데이터를 암호화해서 중간에 다른 사람이 요청을 가로채더라도 내용을 확인할 수 없게 한다. 

### 4.5 cluster

cluster 모듈은 기본적으로 싱글 프로세르로 동작하는 노드가 CPU 코어를 모두 사용할 수 있게 해주는 모듈이다. 

포트를 공유하는 노드 프로세스를 여러 개 둘 수도 있으므로, 요청이 많이 들어왔을 때 병렬로 실행된 서버의 개수만큼 요청이 분산되게 할 수 있다.

------

질문, 이해가 안 갔던 것, 궁금한 것, 스터디장이나 다른 사람들에게 물어보고 싶은 것, 기타 등등이 있으시면 써주시고, 이 문구는 지워주세요!
