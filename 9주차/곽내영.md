# 9주차 JS 스터디 정리

| 장   | 제목               |
| ---- | ------------------ |
| 11장 | 노드 서비스 테스트하기 |

## 11장

### 11.1 테스트 준비하기
테스트에 사용할 패키지는 jest이다. 이 패키지는 페이스북에서 만든 오픈소스로, 테스팅에 필요한 툴들을 대부분 갖추고 있어 편리하다. 

**왜 테스트를 작성하는가?**
: 테스트가 실패하면 정확히 어떤 부분에서 실패했는지 시각적으로 보여준다. 따라서 코드에 대해 테스트를 작성해두면 어떤 부분에 문제가 있는지 명확하게 파악할 수 있다.

### 11.2 유닛 테스트
- **모킹(mocking) :** 가짜 객체, 가짜 함수를 넣는 행위
- **유닛 테스트(unit test) 또는 단위 테스트** : 작은 단위의 함수나 모듈이 의도한 대로 정확히 작동하는지 테스트하는 것

### 11.3 테스트 커버리지
- **커버리지 기능** : 전체 코드 중에서 테스트되고 있는 코드의 비율과 테스트되고 있지 않은 코드의 위치를 알려주는 jest의 기능
- jest 명령어 뒤에 —coverage 옵션을 붙이면 jest가 테스트 커버리지를 분석한다.
    - File(파일 이름과 폴더 이름), % Stmts(구문 비율), % Branch(if문 등의 분기점 비율), % Funcs(함수 비율), % Lines(코드 줄 수 비율), Uncovered Line #s(커버되지 않는 줄 위치)
        → 퍼센티지가 높을 수록 많은 코드가 테스트되었다는 뜻이다.

### 11.4 통합 테스트
- **통합 테스트** : 하나의 라우터에는 여러 개의 미들웨어가 붙어 있고, 다양한 라이브러리가 사용된다. 이런 것들이 모두 유기적으로 잘 작동되는지 테스트 하는 것이다.
- 통합 테스트에서는 데이터베이스 코드를 모킹하지 않으므로 데이터베이스에 실제로 테스트용 데이터가 저장된다. 그런데 실제 서비스 중인 데이터베이스에 테스트용 데이터가 들어가면 안 되므로, 테스트용 데이터베이스를 따로 만드는 것이 좋다.

### 11.5 부하 테스트
- **부하 테스트** : 서버가 얼마만큼의 요청을 견딜 수 있는지 (또는 수용할 수 있는지) 테스트하는 방법이다.
- 일반적으로 요청-응답 시 데이터베이스에 접근할 때 가장 많은 시간이 소요된다. 서버는 여러 대로 늘리기 쉽지만, 데이터베이스는 늘리기 어려우므로 하나의 데이터베이스에 많은 요청이 몰리곤 한다. 따라서 최대한 데이터베이스에 접근하는 요청을 줄이면 좋다. 반복적으로 가져오는 데이터는 캐싱을 한다든지 하여 데이터베이스에 접근하는 일을 줄이도록 한다.

### 11.6 프로젝트 마무리하기
프로그램에서 그 패키지나 라이브러리를 사용하는 부분을 테스트하면 된다. 테스트하기 어려운 패키지는 모킹하고, 테스트할 수 있는 패키지는 그대로 테스트한다. 단, 모킹할 때는 실제 상황에서는 에러가 발생할 수 있음을 염두해야 된다.

**[11단원 핵심 정리]**

- 테스트를 작성한다고 해서 에러가 발생하지 않는 것은 아니다. 하지만 자신의 코드에 대한 믿음을 가질 수는 있다.
- 테스트를 올바르게 작성하지 않으면 테스트를 하지 않는 것보다 못한 상황이 발생한다.
- 테스트를 작성하면 나중에 코드 변경 사항이 생겼을 때 어떤 부분에 영향을 미치는지 쉽게 파악할 수 있다. 이러면 긍정적인 영향과 테스트하는 데 필요한 공수를 함께 고려해서 테스트할 범위를 정해야 한다.
- 실제 서비스에서는 모든 기능을 테스트하기가 어려우므로 우선순위를 정하여 우선순위가 높은 기능 위주로 테스트한다.
- 테스트 커버리지가 100%라고 해서 에러가 발생하지 않는 것은 아니다.
---

